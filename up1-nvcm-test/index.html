<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Up1</title>
  
  <script src="https://assets.mycartpanda.com/cartx-ecomm-ui-assets/js/libs/ocu-external.js"></script>
  <script>
    new OcuExternal();
  </script>
  
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background-color: #f9f9f9;
      color: #000;
      margin: 0;
      padding: 0;
    }
    .top-menu {
      background-color: red;
      padding: 5px;
      text-align: center;
      font-weight: bold;
      font-size: 0.9em;
      color: white;
      width: 100%;
      box-sizing: border-box;
    }
    .page-wrapper {
      padding: 10px;
    }
    .highlight {
      color: green;
      font-weight: bold;
    }
    .section {
      padding: 5px;
    }
    .center {
      text-align: center;
    }
  </style>
</head>
<body>

  <div class="top-menu">
    ETAPA 1 DE 2
  </div>

  <div class="page-wrapper">
    <div class="section">
      <p>Hola, aquí el Dra. Sofía Martínez nuevamente...</p>
      <p><strong class="highlight">Quiero felicitarte</strong> por asegurar el acceso al <strong>Mounjaro Japonés Casero</strong>.</p>
      <p>Sin duda, fue una de las decisiones más importantes de tu vida — y no puedo esperar para escuchar tu testimonio pronto.</p>
      <p>Ahora queremos mostrarte cómo acceder a la aplicación para que puedas empezar a seguir el protocolo.</p>
      <p>A continuación, verás un botón...</p>
      <p>Haz clic en él para ir a nuestra página con las instrucciones.</p>

      <div class="center">
        <!-- Removido target="_blank" para abrir o modal inline -->
        <a id="autoClickBtn"
           href="https://vm-business.mycartpanda.com/ex-ocu/next-offer/ZyVpl4dVPG?accepted=yes"
           style="display: inline-block; margin-top: 10px; padding: 10px 20px; background-color: #28a745; color: white; text-decoration: none; font-weight: bold; border-radius: 5px;">
          Ir a las instrucciones
        </a>
      </div>
    </div>

    <div class="section">
      <p>Nos vemos del otro lado,<br>Dra. Sofía Martínez</p>
    </div>
  </div>

  <!-- Script para auto-clique e confirmação via MutationObserver -->
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      // Depois de 25s, dispara o clique no link
      setTimeout(function() {
        var link = document.getElementById('autoClickBtn');
        if (link) link.click();

        // Observa inserção do modal e clica no botão de confirmação assim que disponível
        var observer = new MutationObserver(function(mutations, obs) {
          mutations.forEach(function(mutation) {
            mutation.addedNodes.forEach(function(node) {
              if (node.nodeType === 1) { // elemento
                // Busca o botão de confirmação dentro do nó adicionado
                var confirmBtn = node.querySelector('#cartpanda-payment-confirmation');
                if (confirmBtn) {
                  confirmBtn.click();
                  obs.disconnect(); // para de observar
                }
              }
            });
          });
        });
        observer.observe(document.body, { childList: true, subtree: true });
      }, 25000);
    });
  </script>
</body>
</html>
